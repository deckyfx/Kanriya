<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:Kanriya.Client.Avalonia.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="Kanriya.Client.Avalonia.Views.DisplayImageView"
             x:DataType="vm:DisplayImageViewModel">
  
  <Grid RowDefinitions="Auto,*" Margin="20">
    <!-- Page Header -->
    <TextBlock Grid.Row="0" Text="{Binding PageTitle}" Classes="h2" Margin="0,0,0,20"/>
    
    <!-- Content -->
    <Grid Grid.Row="1" ColumnDefinitions="300,*">
      <!-- Image List -->
      <Border Grid.Column="0" 
              Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
              CornerRadius="8"
              Padding="10"
              Margin="0,0,10,0">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
          <StackPanel Spacing="4">
            <TextBlock Text="Test Images" Classes="h5" Margin="0,0,0,10"/>
            
            <ItemsControl ItemsSource="{Binding ImageTests}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Button Command="{Binding $parent[UserControl].DataContext.LoadImageCommand}"
                          CommandParameter="{Binding}"
                          HorizontalAlignment="Stretch"
                          HorizontalContentAlignment="Left"
                          Background="Transparent"
                          BorderThickness="0"
                          Padding="8"
                          Margin="0,2">
                    <StackPanel>
                      <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                      <TextBlock Text="{Binding Description}" 
                                 Classes="caption"
                                 Opacity="0.7"/>
                    </StackPanel>
                  </Button>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </StackPanel>
        </ScrollViewer>
      </Border>
      
      <!-- Image Display Area -->
      <Border Grid.Column="1" 
              Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
              CornerRadius="8"
              Padding="20">
        <Grid RowDefinitions="Auto,*,Auto">
          <!-- Display Area Header -->
          <TextBlock Grid.Row="0" 
                     Text="Image Display" 
                     Classes="h5" 
                     Margin="0,0,0,15"/>
          
          <!-- Image Container -->
          <Border Grid.Row="1" 
                  Background="White"
                  CornerRadius="4"
                  BorderThickness="1"
                  BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                  Margin="0,0,0,15">
            <Grid>
              <!-- Checkerboard Background for Transparency -->
              <Grid.Background>
                <DrawingBrush TileMode="Tile" Viewport="0,0,20,20" ViewportUnits="Absolute">
                  <DrawingBrush.Drawing>
                    <DrawingGroup>
                      <GeometryDrawing Geometry="M0,0 L20,0 L20,20 L0,20 Z">
                        <GeometryDrawing.Brush>
                          <SolidColorBrush Color="#F0F0F0"/>
                        </GeometryDrawing.Brush>
                      </GeometryDrawing>
                      <GeometryDrawing Geometry="M0,0 L10,0 L10,10 L0,10 Z">
                        <GeometryDrawing.Brush>
                          <SolidColorBrush Color="#E0E0E0"/>
                        </GeometryDrawing.Brush>
                      </GeometryDrawing>
                      <GeometryDrawing Geometry="M10,10 L20,10 L20,20 L10,20 Z">
                        <GeometryDrawing.Brush>
                          <SolidColorBrush Color="#E0E0E0"/>
                        </GeometryDrawing.Brush>
                      </GeometryDrawing>
                    </DrawingGroup>
                  </DrawingBrush.Drawing>
                </DrawingBrush>
              </Grid.Background>
              
              <!-- Actual Image -->
              <Image Source="{Binding CurrentImageUrl}"
                     Stretch="Uniform"
                     MaxWidth="600"
                     MaxHeight="400"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center"
                     Margin="20"/>
              
              <!-- Placeholder when no image -->
              <TextBlock Text="Select an image from the list to display"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"
                         Opacity="0.5"
                         IsVisible="{Binding !CurrentImageUrl}"/>
            </Grid>
          </Border>
          
          <!-- Image Info -->
          <StackPanel Grid.Row="2" Spacing="5">
            <TextBlock Text="Image URL/Path:" Classes="caption" FontWeight="SemiBold"/>
            <TextBox Text="{Binding CurrentImageUrl}"
                     IsReadOnly="True"
                     FontFamily="{StaticResource MonospaceFontFamily}"
                     FontSize="12"
                     Background="Transparent"
                     BorderThickness="1"
                     Padding="8"/>
            
            <!-- Test Different Image Formats -->
            <Grid ColumnDefinitions="*,*,*" Margin="0,10,0,0">
              <StackPanel Grid.Column="0" Spacing="5">
                <TextBlock Text="Embedded Images:" Classes="caption" FontWeight="SemiBold"/>
                <Image Source="avares://Kanriya.Client.Avalonia/Assets/Icons/kanriya-logo.png"
                       Width="50"
                       Height="50"
                       ToolTip.Tip="Embedded PNG"/>
              </StackPanel>
              
              <StackPanel Grid.Column="1" Spacing="5">
                <TextBlock Text="Remote Images:" Classes="caption" FontWeight="SemiBold"/>
                <Image Source="https://via.placeholder.com/50"
                       Width="50"
                       Height="50"
                       ToolTip.Tip="Remote Image"/>
              </StackPanel>
              
              <StackPanel Grid.Column="2" Spacing="5">
                <TextBlock Text="SVG Support:" Classes="caption" FontWeight="SemiBold"/>
                <Border Width="50" Height="50" Background="#667eea" CornerRadius="4">
                  <TextBlock Text="SVG" 
                             HorizontalAlignment="Center" 
                             VerticalAlignment="Center"
                             Foreground="White"
                             FontSize="12"/>
                </Border>
              </StackPanel>
            </Grid>
          </StackPanel>
        </Grid>
      </Border>
    </Grid>
  </Grid>
</UserControl>